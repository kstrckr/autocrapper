/*var inputFolder = Folder.selectDialog ("Select selects");var outputFolder = Folder.selectDialog("Select Output Destination");var dirtyFileList = inputFolder.getFiles();var fileList = [];while (dirtyFileList.length > 0){    if (dirtyFileList[0].hidden === true){        dirtyFileList.splice(0,1);        };    var nextFile = dirtyFileList.shift();    fileList.push(nextFile);};open(fileList[0]);*/var doc = app.activeDocumentvar guides = doc.guides;var width = doc.width;var height = doc.height;var readHistogram = function(pixelTotal) {    var histo = doc.histogram;        /*    var sum = function(arr) {        var total = 0;                for (var i = 0; i < arr.length; i++){            total += arr[i];            }                return total;        };        */        var findWeightedAvg = function(arr, total){        var avgTally = 0;                for (var i = 0; i < arr.length; i++){                             avgTally += i*(arr[i]/total);            }                return avgTally        }        var findStdDev = function(arr, mean, total){        var stdTally = 0;                for (var i = 0; i < arr.length; i++){            stdTally += Math.pow((mean-i), 2)*arr[i];            }                stdTally /= total;                return Math.sqrt(stdTally);                }        var histoMean = findWeightedAvg(histo, pixelTotal);    var histoStdDev = findStdDev(histo, histoMean, pixelTotal);        return histoStdDev;        }var drawHorizontal = function(d) {        var mid = height/2;            var selectionBounds = [    [0, (mid-1)-d],    [width, (mid-1)-d],    [width, (mid)-d],    [0, (mid)-d]    ];        doc.selection.select(selectionBounds, SelectionType.REPLACE,0,false);    };var scanVertical = function(start, delta){    drawHorizontal(start);    //var edgeCheck = readHistogram(width);         var edgeCheckArray = []    edgeCheckArray[0] = 100;    edgeCheckArray[1] = readHistogram(width);        var position = start;        while (edgeCheckArray[1] > 2 && Math.abs(edgeCheckArray[1]-edgeCheckArray[0]) > .05){        position += delta;        drawHorizontal(position);        edgeCheckArray[0] = edgeCheckArray[1]        edgeCheckArray[1] = readHistogram(width);        }            var edgeLocation = doc.selection.bounds    return edgeLocation[1];};var top = scanVertical(0, 20);guides.add (Direction.HORIZONTAL, top);var bottom = scanVertical(0, -20);guides.add (Direction.HORIZONTAL, bottom);